(()=>{"use strict";class t{constructor(){this.toLoad=0,this.loaded=0,this.isLoaded=!1,this.list={}}load(t){const s=["png"],i=["json"],e=["toml"];return this.toLoad=t.length,new Promise((n=>{t.forEach((t=>{const a=t.split(".").pop()||"";s.includes(a)?this.loadImage(t,n):i.includes(a)?this.loadJson(t,n):e.includes(a)&&this.loadConfig(t,n)}))}))}loadHandler(t){this.loaded+=1,this.loaded===this.toLoad&&(this.loaded=0,this.toLoad=0,t(this),this.isLoaded=!0)}loadImage(t,s){const i=new Image;i.src=t,i.addEventListener("load",(()=>{this.loadHandler(s)}),!1);const e=t.split("/").pop().split(".")[0];e&&(this.list[e]=i)}async loadConfig(t,s){fetch(t).then((t=>t.text())).then((s=>{const i=s.split("\n").reduce(((t,s)=>{const[i,e]=s.trim().split("=");return i&&e?(t[i.trim()]=e.trim(),t):t}),{}),e=t.split("/").pop().split(".")[0];e&&(this.list[e]=i)}))}async loadJson(t,s){try{const i=await fetch(t),e=await i.json();this.loadHandler(s);const n=t.split("/").pop().split(".")[0];this.list[n]=e}catch(t){}}}class s{error(t){console.error(t)}warn(t){console.warn(t)}info(t){console.info("ℹ️ "+t)}debug(t){console.log("📝 "+t)}}class i{constructor(){this.logger=new s,this.windowSize={width:256,height:240},this.canvas=document.createElement("canvas"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.ctx=this.canvas.getContext("2d"),this.ctx.imageSmoothingEnabled=!1,this.ctx.scale(this.canvas.width/this.windowSize.width,this.canvas.height/this.windowSize.height),document.querySelector("#main").append(this.canvas),this.logger.info("Renderer initialized"),window.addEventListener("resize",(()=>this.resize()))}resize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.ctx.scale(this.canvas.width/this.windowSize.width,this.canvas.height/this.windowSize.height),this.ctx.imageSmoothingEnabled=!1}drawText(t,s,i){t.split("").forEach(((t,e)=>{this.ctx.drawImage(s,i[t].x,i[t].y,i[t].w,i[t].h,8*e,0,8,8)}))}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}}var e;!function(t){t[t.MENU=0]="MENU",t[t.PLAYING=1]="PLAYING",t[t.PAUSED=2]="PAUSED",t[t.GAME_OVER=3]="GAME_OVER",t[t.OPTIONS=4]="OPTIONS",t[t.LOADING=5]="LOADING"}(e||(e={})),(new class{constructor(){this.renderer=new i,this.assetLoader=new t,this.lastTime=0,this.logger=new s,this.logger.info("Game started"),window.game=this}update(t){this.lastTime,this.lastTime=t}render(){this.renderer.drawText("SPACE SHOOTER GAIDEN V0.1",this.assetLoader.list.spritesheet,this.assetLoader.list.spritesheet_map)}run(){this.logger.info("Game running"),this.assetLoader.load(["assets/spritesheet.png","assets/spritesheet_map.json"]).then((()=>{this.logger.info("Assets loaded"),this.loop()}))}loop(){this.update(performance.now()),this.render(),requestAnimationFrame((()=>this.loop()))}}).run()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aUYsU0FBVyxJQUFJL0IsRUFDcEJsRCxLQUFLa0YsWUFBYyxJQUFJcEYsRUFDdkJFLEtBQUttRixTQUFXLEVBQ2hCbkYsS0FBS21ELE9BQVMsSUFBSVIsRUFDbEIzQyxLQUFLbUQsT0FBT0osS0FBSyxnQkFFakJXLE9BQWEsS0FBSTFELElBQ3JCLENBQ0FvRixPQUFPQyxHQUNhckYsS0FBS21GLFNBQ3JCbkYsS0FBS21GLFNBQVdFLENBQ3BCLENBQ0FDLFNBQ0l0RixLQUFLaUYsU0FBU2IsU0FBUyw0QkFBNkJwRSxLQUFLa0YsWUFBWTlFLEtBQWtCLFlBQUdKLEtBQUtrRixZQUFZOUUsS0FBc0IsZ0JBQ3JJLENBQ0FtRixNQUNJdkYsS0FBS21ELE9BQU9KLEtBQUssZ0JBQ2pCL0MsS0FBS2tGLFlBQ0E3RSxLQUFLLENBQUMseUJBQTBCLGdDQUNoQ3lCLE1BQUssS0FDTjlCLEtBQUttRCxPQUFPSixLQUFLLGlCQUNqQi9DLEtBQUt3RixNQUFNLEdBRW5CLENBQ0FBLE9BQ0l4RixLQUFLb0YsT0FBT0ssWUFBWUMsT0FDeEIxRixLQUFLc0YsU0FDTEssdUJBQXNCLElBQU0zRixLQUFLd0YsUUFDckMsSUN4Q0NELEsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zcGFjZXNob290ZXJnYWlkZW4vLi9zcmMvYXNzZXRsb2FkZXIudHMiLCJ3ZWJwYWNrOi8vc3BhY2VzaG9vdGVyZ2FpZGVuLy4vc3JjL2xvZ2dlci50cyIsIndlYnBhY2s6Ly9zcGFjZXNob290ZXJnYWlkZW4vLi9zcmMvcmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vc3BhY2VzaG9vdGVyZ2FpZGVuLy4vc3JjL2dhbWUudHMiLCJ3ZWJwYWNrOi8vc3BhY2VzaG9vdGVyZ2FpZGVuLy4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vQHRzLW5vY2hlY2tcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFzc2V0TG9hZGVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy50b0xvYWQgPSAwO1xuICAgICAgICB0aGlzLmxvYWRlZCA9IDA7XG4gICAgICAgIHRoaXMuaXNMb2FkZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5saXN0ID0ge307XG4gICAgfVxuICAgIGxvYWQoYXNzZXRzKSB7XG4gICAgICAgIGNvbnN0IGltYWdlRXh0ID0gW1wicG5nXCJdO1xuICAgICAgICBjb25zdCBqc29uRXh0ID0gW1wianNvblwiXTtcbiAgICAgICAgY29uc3QgY29uZmlnRXh0ID0gW1widG9tbFwiXTtcbiAgICAgICAgdGhpcy50b0xvYWQgPSBhc3NldHMubGVuZ3RoO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgICAgIGFzc2V0cy5mb3JFYWNoKChhc3NldCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGV4dGVuc2lvbiA9IGFzc2V0LnNwbGl0KFwiLlwiKS5wb3AoKSB8fCBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChpbWFnZUV4dC5pbmNsdWRlcyhleHRlbnNpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZEltYWdlKGFzc2V0LCByZXNvbHZlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoanNvbkV4dC5pbmNsdWRlcyhleHRlbnNpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZEpzb24oYXNzZXQsIHJlc29sdmUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjb25maWdFeHQuaW5jbHVkZXMoZXh0ZW5zaW9uKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRDb25maWcoYXNzZXQsIHJlc29sdmUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgbG9hZEhhbmRsZXIocmVzb2x2ZSkge1xuICAgICAgICB0aGlzLmxvYWRlZCArPSAxO1xuICAgICAgICBpZiAodGhpcy5sb2FkZWQgPT09IHRoaXMudG9Mb2FkKSB7XG4gICAgICAgICAgICB0aGlzLmxvYWRlZCA9IDA7XG4gICAgICAgICAgICB0aGlzLnRvTG9hZCA9IDA7XG4gICAgICAgICAgICByZXNvbHZlKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5pc0xvYWRlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbG9hZEltYWdlKHNyYywgcmVzb2x2ZSkge1xuICAgICAgICBjb25zdCBpbWFnZSA9IG5ldyBJbWFnZSgpO1xuICAgICAgICBpbWFnZS5zcmMgPSBzcmM7XG4gICAgICAgIGltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMubG9hZEhhbmRsZXIocmVzb2x2ZSk7XG4gICAgICAgIH0sIGZhbHNlKTtcbiAgICAgICAgY29uc3QgbmFtZSA9IHNyYy5zcGxpdChcIi9cIikucG9wKCkuc3BsaXQoXCIuXCIpWzBdO1xuICAgICAgICBpZiAobmFtZSkge1xuICAgICAgICAgICAgdGhpcy5saXN0W25hbWVdID0gaW1hZ2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgbG9hZENvbmZpZyhzcmMsIHJlc29sdmUpIHtcbiAgICAgICAgZmV0Y2goc3JjKVxuICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IGRhdGEudGV4dCgpKVxuICAgICAgICAgICAgLnRoZW4oKHRleHQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IHRleHQuc3BsaXQoXCJcXG5cIikucmVkdWNlKChvYmosIHN0cikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IFtrZXksIHZhbHVlXSA9IHN0ci50cmltKCkuc3BsaXQoXCI9XCIpO1xuICAgICAgICAgICAgICAgIGlmICgha2V5IHx8ICF2YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgICAgICBvYmpba2V5LnRyaW0oKV0gPSB2YWx1ZS50cmltKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgIH0sIHt9KTtcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBzcmMuc3BsaXQoXCIvXCIpLnBvcCgpLnNwbGl0KFwiLlwiKVswXTtcbiAgICAgICAgICAgIGlmIChuYW1lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saXN0W25hbWVdID0gY29uZmlnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYXN5bmMgbG9hZEpzb24oc3JjLCByZXNvbHZlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHNyYyk7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgdGhpcy5sb2FkSGFuZGxlcihyZXNvbHZlKTtcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBzcmMuc3BsaXQoXCIvXCIpLnBvcCgpLnNwbGl0KFwiLlwiKVswXTtcbiAgICAgICAgICAgIHRoaXMubGlzdFtuYW1lXSA9IGRhdGE7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7IH1cbiAgICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBMb2dnZXIge1xuICAgIGVycm9yKG1lc3NhZ2UpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihtZXNzYWdlKTtcbiAgICB9XG4gICAgd2FybihtZXNzYWdlKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihtZXNzYWdlKTtcbiAgICB9XG4gICAgaW5mbyhtZXNzYWdlKSB7XG4gICAgICAgIGNvbnNvbGUuaW5mbyhcIuKEue+4jyBcIiArIG1lc3NhZ2UpO1xuICAgIH1cbiAgICBkZWJ1ZyhtZXNzYWdlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwi8J+TnSBcIiArIG1lc3NhZ2UpO1xuICAgIH1cbn1cbiIsImltcG9ydCBMb2dnZXIgZnJvbSBcIi4vbG9nZ2VyXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZW5kZXJlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMubG9nZ2VyID0gbmV3IExvZ2dlcigpO1xuICAgICAgICB0aGlzLndpbmRvd1NpemUgPSB7XG4gICAgICAgICAgICB3aWR0aDogMjU2LFxuICAgICAgICAgICAgaGVpZ2h0OiAyNDAsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcbiAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuICAgICAgICB0aGlzLmN0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICAgICAgdGhpcy5jdHguaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY3R4LnNjYWxlKHRoaXMuY2FudmFzLndpZHRoIC8gdGhpcy53aW5kb3dTaXplLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQgLyB0aGlzLndpbmRvd1NpemUuaGVpZ2h0KTtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtYWluXCIpLmFwcGVuZCh0aGlzLmNhbnZhcyk7XG4gICAgICAgIHRoaXMubG9nZ2VyLmluZm8oXCJSZW5kZXJlciBpbml0aWFsaXplZFwiKTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgKCkgPT4gdGhpcy5yZXNpemUoKSk7XG4gICAgfVxuICAgIHJlc2l6ZSgpIHtcbiAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuICAgICAgICB0aGlzLmN0eC5zY2FsZSh0aGlzLmNhbnZhcy53aWR0aCAvIHRoaXMud2luZG93U2l6ZS53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0IC8gdGhpcy53aW5kb3dTaXplLmhlaWdodCk7XG4gICAgICAgIHRoaXMuY3R4LmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgICBkcmF3VGV4dCh0ZXh0LCBzcHJpdGVTaGVldCwgc3ByaXRlU2hlZXRNYXApIHtcbiAgICAgICAgdGV4dC5zcGxpdChcIlwiKS5mb3JFYWNoKChjaGFyLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jdHguZHJhd0ltYWdlKHNwcml0ZVNoZWV0LCBzcHJpdGVTaGVldE1hcFtjaGFyXS54LCBzcHJpdGVTaGVldE1hcFtjaGFyXS55LCBzcHJpdGVTaGVldE1hcFtjaGFyXS53LCBzcHJpdGVTaGVldE1hcFtjaGFyXS5oLCBpbmRleCAqIDgsIDAsIDgsIDgpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgY2xlYXIoKSB7XG4gICAgICAgIHRoaXMuY3R4LmNsZWFyUmVjdCgwLCAwLCB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgQXNzZXRMb2FkZXIgZnJvbSBcIi4vYXNzZXRsb2FkZXJcIjtcbmltcG9ydCBMb2dnZXIgZnJvbSBcIi4vbG9nZ2VyXCI7XG5pbXBvcnQgUmVuZGVyZXIgZnJvbSBcIi4vcmVuZGVyZXJcIjtcbnZhciBHYW1lU3RhdGU7XG4oZnVuY3Rpb24gKEdhbWVTdGF0ZSkge1xuICAgIEdhbWVTdGF0ZVtHYW1lU3RhdGVbXCJNRU5VXCJdID0gMF0gPSBcIk1FTlVcIjtcbiAgICBHYW1lU3RhdGVbR2FtZVN0YXRlW1wiUExBWUlOR1wiXSA9IDFdID0gXCJQTEFZSU5HXCI7XG4gICAgR2FtZVN0YXRlW0dhbWVTdGF0ZVtcIlBBVVNFRFwiXSA9IDJdID0gXCJQQVVTRURcIjtcbiAgICBHYW1lU3RhdGVbR2FtZVN0YXRlW1wiR0FNRV9PVkVSXCJdID0gM10gPSBcIkdBTUVfT1ZFUlwiO1xuICAgIEdhbWVTdGF0ZVtHYW1lU3RhdGVbXCJPUFRJT05TXCJdID0gNF0gPSBcIk9QVElPTlNcIjtcbiAgICBHYW1lU3RhdGVbR2FtZVN0YXRlW1wiTE9BRElOR1wiXSA9IDVdID0gXCJMT0FESU5HXCI7XG59KShHYW1lU3RhdGUgfHwgKEdhbWVTdGF0ZSA9IHt9KSk7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlciA9IG5ldyBSZW5kZXJlcigpO1xuICAgICAgICB0aGlzLmFzc2V0TG9hZGVyID0gbmV3IEFzc2V0TG9hZGVyKCk7XG4gICAgICAgIHRoaXMubGFzdFRpbWUgPSAwO1xuICAgICAgICB0aGlzLmxvZ2dlciA9IG5ldyBMb2dnZXIoKTtcbiAgICAgICAgdGhpcy5sb2dnZXIuaW5mbyhcIkdhbWUgc3RhcnRlZFwiKTtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB3aW5kb3dbXCJnYW1lXCJdID0gdGhpcztcbiAgICB9XG4gICAgdXBkYXRlKHRzKSB7XG4gICAgICAgIGNvbnN0IGR0ID0gdHMgLSB0aGlzLmxhc3RUaW1lO1xuICAgICAgICB0aGlzLmxhc3RUaW1lID0gdHM7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5kcmF3VGV4dChcIlNQQUNFIFNIT09URVIgR0FJREVOIFYwLjFcIiwgdGhpcy5hc3NldExvYWRlci5saXN0W1wic3ByaXRlc2hlZXRcIl0sIHRoaXMuYXNzZXRMb2FkZXIubGlzdFtcInNwcml0ZXNoZWV0X21hcFwiXSk7XG4gICAgfVxuICAgIHJ1bigpIHtcbiAgICAgICAgdGhpcy5sb2dnZXIuaW5mbyhcIkdhbWUgcnVubmluZ1wiKTtcbiAgICAgICAgdGhpcy5hc3NldExvYWRlclxuICAgICAgICAgICAgLmxvYWQoW1wiYXNzZXRzL3Nwcml0ZXNoZWV0LnBuZ1wiLCBcImFzc2V0cy9zcHJpdGVzaGVldF9tYXAuanNvblwiXSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmluZm8oXCJBc3NldHMgbG9hZGVkXCIpO1xuICAgICAgICAgICAgdGhpcy5sb29wKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBsb29wKCkge1xuICAgICAgICB0aGlzLnVwZGF0ZShwZXJmb3JtYW5jZS5ub3coKSk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB0aGlzLmxvb3AoKSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IEdhbWUgZnJvbSBcIi4vZ2FtZVwiO1xuY29uc3QgZ2FtZSA9IG5ldyBHYW1lKCk7XG5nYW1lLnJ1bigpO1xuIl0sIm5hbWVzIjpbIkFzc2V0TG9hZGVyIiwiY29uc3RydWN0b3IiLCJ0aGlzIiwidG9Mb2FkIiwibG9hZGVkIiwiaXNMb2FkZWQiLCJsaXN0IiwibG9hZCIsImFzc2V0cyIsImltYWdlRXh0IiwianNvbkV4dCIsImNvbmZpZ0V4dCIsImxlbmd0aCIsIlByb21pc2UiLCJyZXNvbHZlIiwiZm9yRWFjaCIsImFzc2V0IiwiZXh0ZW5zaW9uIiwic3BsaXQiLCJwb3AiLCJpbmNsdWRlcyIsImxvYWRJbWFnZSIsImxvYWRKc29uIiwibG9hZENvbmZpZyIsImxvYWRIYW5kbGVyIiwic3JjIiwiaW1hZ2UiLCJJbWFnZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJuYW1lIiwiYXN5bmMiLCJmZXRjaCIsInRoZW4iLCJkYXRhIiwidGV4dCIsImNvbmZpZyIsInJlZHVjZSIsIm9iaiIsInN0ciIsImtleSIsInZhbHVlIiwidHJpbSIsInJlc3BvbnNlIiwianNvbiIsImVycm9yIiwiTG9nZ2VyIiwibWVzc2FnZSIsImNvbnNvbGUiLCJ3YXJuIiwiaW5mbyIsImRlYnVnIiwibG9nIiwiUmVuZGVyZXIiLCJsb2dnZXIiLCJ3aW5kb3dTaXplIiwid2lkdGgiLCJoZWlnaHQiLCJjYW52YXMiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJjdHgiLCJnZXRDb250ZXh0IiwiaW1hZ2VTbW9vdGhpbmdFbmFibGVkIiwic2NhbGUiLCJxdWVyeVNlbGVjdG9yIiwiYXBwZW5kIiwicmVzaXplIiwiZHJhd1RleHQiLCJzcHJpdGVTaGVldCIsInNwcml0ZVNoZWV0TWFwIiwiY2hhciIsImluZGV4IiwiZHJhd0ltYWdlIiwieCIsInkiLCJ3IiwiaCIsImNsZWFyIiwiY2xlYXJSZWN0IiwiR2FtZVN0YXRlIiwicmVuZGVyZXIiLCJhc3NldExvYWRlciIsImxhc3RUaW1lIiwidXBkYXRlIiwidHMiLCJyZW5kZXIiLCJydW4iLCJsb29wIiwicGVyZm9ybWFuY2UiLCJub3ciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiXSwic291cmNlUm9vdCI6IiJ9